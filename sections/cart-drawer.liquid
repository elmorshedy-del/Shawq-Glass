{%- if request.page_type != 'cart' -%}
  {%- capture cart_drawer_style -%}
    {%- if section.settings.drawer_text_color != blank and section.settings.drawer_text_color != 'rgba(0,0,0,0)' -%}
      --text-color: {{ section.settings.drawer_text_color.rgb }};
      --shawq-cart-drawer-text-color: {{ section.settings.drawer_text_color.rgb }};
    {%- endif -%}
    {%- if section.settings.drawer_muted_text_color != blank and section.settings.drawer_muted_text_color != 'rgba(0,0,0,0)' -%}
      --shawq-cart-drawer-muted-color: {{ section.settings.drawer_muted_text_color.rgb }};
    {%- endif -%}
    {%- if section.settings.drawer_heading_color != blank and section.settings.drawer_heading_color != 'rgba(0,0,0,0)' -%}
      --shawq-cart-drawer-heading-color: {{ section.settings.drawer_heading_color.rgb }};
    {%- endif -%}
    {%- if section.settings.drawer_price_color != blank and section.settings.drawer_price_color != 'rgba(0,0,0,0)' -%}
      --shawq-cart-drawer-price-color: {{ section.settings.drawer_price_color.rgb }};
    {%- endif -%}
    {%- if section.settings.drawer_button_background != blank and section.settings.drawer_button_background != 'rgba(0,0,0,0)' -%}
      --button-background-primary: {{ section.settings.drawer_button_background.rgb }};
    {%- endif -%}
    {%- if section.settings.drawer_button_text_color != blank and section.settings.drawer_button_text_color != 'rgba(0,0,0,0)' -%}
      --button-text-primary: {{ section.settings.drawer_button_text_color.rgb }};
    {%- endif -%}
    {%- if section.settings.drawer_heading_weight != blank -%}
      --shawq-cart-drawer-heading-weight: {{ section.settings.drawer_heading_weight }};
    {%- endif -%}
    {%- if section.settings.drawer_body_weight != blank -%}
      --shawq-cart-drawer-body-weight: {{ section.settings.drawer_body_weight }};
    {%- endif -%}
    {%- if section.settings.drawer_price_weight != blank -%}
      --shawq-cart-drawer-price-weight: {{ section.settings.drawer_price_weight }};
    {%- endif -%}
    {%- if section.settings.drawer_button_weight != blank -%}
      --shawq-cart-drawer-button-weight: {{ section.settings.drawer_button_weight }};
    {%- endif -%}
    {%- if section.settings.drawer_notice_color != blank and section.settings.drawer_notice_color != 'rgba(0,0,0,0)' -%}
      --shawq-cart-drawer-notice-color: {{ section.settings.drawer_notice_color.rgb }};
    {%- endif -%}
    {%- if section.settings.drawer_notice_weight != blank -%}
      --shawq-cart-drawer-notice-weight: {{ section.settings.drawer_notice_weight }};
    {%- endif -%}
  {%- endcapture -%}
  {%- assign cart_drawer_style = cart_drawer_style | strip_newlines | strip -%}

  <cart-drawer id="cart-drawer" class="drawer drawer--cart color-scheme color-scheme--{{ section.settings.color_scheme.id }}" aria-label="{{ 'cart.general.title' | t | escape }}" handle-editor-events{% if cart_drawer_style != blank %} style="{{ cart_drawer_style }}"{% endif %}>
    {%- comment -%}HEADER PART{%- endcomment -%}
    <div class="text-with-icon" slot="header">
      {%- render 'icon' with 'cart' -%}
      <h2 class="h7">{{ 'cart.general.title' | t }} {% unless cart.empty? %}({{ cart.item_count }}){% endunless %}</h2>
    </div>

    {%- comment -%}
    IMPLEMENTATION NOTE: for the content, we first capture the offers and the main cart content (with line items). If there are offers, we conditionnally
                        render the content in tabs. If there are no offers, we render the cart content directly. This allows to make sure we do not create
                        tabs for nothing, as this forces extra JavaScript.
    {%- endcomment -%}

    {%- capture offers_content -%}
      {%- capture offers_blocks -%}
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when 'offer_banner' -%}
              <div class="cart-offers__item {% if block.settings.layout == 'full_width' %}cart-offers__item--full{% endif %}" {{ block.shopify_attributes }}>
                <div class="offer-item offer-item--lg" style="{% render 'surface', background: block.settings.background, text_color: block.settings.text_color %}">
                  <div class="offer-item__content">
                    {%- render 'icon', image: block.settings.icon, width: block.settings.icon_width -%}

                    {%- if block.settings.subheading != blank or block.settings.content != blank -%}
                      <div class="v-stack gap-1">
                        {%- if block.settings.subheading != blank -%}
                          <p class="bold">{{- block.settings.subheading -}}</p>
                        {%- endif -%}

                        {%- if block.settings.content != blank -%}
                          <div class="prose prose--compact text-subdued">
                            {{- block.settings.content -}}
                          </div>
                        {%- endif -%}
                      </div>
                    {%- endif -%}
                  </div>

                  {%- if block.settings.button_copy_on_click -%}
                    <copy-button class="contents" data-text="{{ block.settings.button_text | escape }}">
                      {%- render 'button', content: block.settings.button_text, href: block.settings.button_link, style: 'outline', size: 'sm', text_color: block.settings.text_color, class: 'shrink-0' -%}
                    </copy-button>
                  {%- else -%}
                    {%- render 'button', content: block.settings.button_text, href: block.settings.button_link, style: 'outline', size: 'sm', text_color: block.settings.text_color, class: 'shrink-0' -%}
                  {%- endif -%}
                </div>
              </div>

            {%- when 'offer_image' -%}
              <div class="cart-offers__item {% if block.settings.layout == 'full_width' %}cart-offers__item--full{% endif %} @container/content-box" {{ block.shopify_attributes }}>
                <div class="content-box" style="{% render 'surface', text_color: block.settings.text_color %}">
                  <div class="content-box__background-media">
                    {%- if block.settings.background_image != blank -%}
                      {{- block.settings.background_image | image_url: width: block.settings.background_image.width | image_tag: loading: 'lazy', widths: '200,300,400,500,600,800,1000,1200' -}}
                    {%- else -%}
                      {{- 'image' | placeholder_svg_tag -}}
                    {%- endif -%}
                  </div>

                  <div class="place-self-center">
                    <div class="prose prose-justify-center prose--compact">
                      {%- if block.settings.heading != blank -%}
                        <p class="h6">{{ block.settings.heading }}</p>
                      {%- endif -%}

                      {%- render 'button', content: block.settings.button_text, href: block.settings.button_link, size: 'sm', style: block.settings.button_style, background: block.settings.button_background, text_color: block.settings.button_text_color, class: 'shrink-0' -%}
                    </div>
                  </div>
                </div>
              </div>
          {%- endcase -%}
        {%- endfor -%}
      {%- endcapture -%}

      {%- if offers_blocks != blank -%}
        <div class="cart-offers">
          {{- offers_blocks -}}
        </div>
      {%- endif -%}
    {%- endcapture -%}

    {%- capture cart_content -%}
      {%- if cart.empty? -%}
        <div class="empty-state">
          <div class="prose prose-justify-center">
            <p class="h5">{{ 'cart.general.empty' | t }}</p>

            {%- assign button_label = 'cart.general.continue_shopping' | t -%}
            {%- render 'button', content: button_label, href: settings.cart_empty_cart_link -%}
          </div>
        </div>
      {%- else -%}
        <div class="v-stack gap-5">
          {%- if settings.cart_show_free_shipping_bar -%}
            {%- render 'free-shipping-bar' -%}
          {%- endif -%}

          <div class="v-stack gap-4">
            {%- if section.settings.drawer_notice_text != blank -%}
              <div class="cart-drawer__notice text-sm">
                {{- section.settings.drawer_notice_text -}}
              </div>
            {%- endif -%}

            {%- liquid
              assign reward_product = section.settings.reward_product

              if reward_product == blank
                assign reward_product = all_products['palestine-frame']
              endif
              assign reward_enabled = section.settings.reward_enable and reward_product != blank
              assign reward_threshold_cents = section.settings.reward_threshold | times: 100
              assign reward_line_item_key = ''
              assign reward_line_item_total = 0
              assign reward_in_cart = false

              if reward_enabled
                for line_item in cart.items
                  if line_item.product_id == reward_product.id
                    assign reward_in_cart = true

                    if line_item.properties['_shawq_reward'] == 'true'
                      assign reward_line_item_key = line_item.key
                      assign reward_line_item_total = line_item.original_line_price
                    endif
                  endif
                endfor
              endif

              assign reward_subtotal = cart.items_subtotal_price | minus: reward_line_item_total
              assign reward_unlocked = reward_enabled and reward_subtotal >= reward_threshold_cents
            -%}

            {%- if reward_enabled -%}
              {%- capture reward_style -%}
                --shawq-reward-text-color: {{ section.settings.reward_message_color.rgb }};
                --shawq-reward-text-anim-speed: {{ section.settings.reward_message_anim_speed }}s;
                --shawq-reward-confetti-speed: {{ section.settings.reward_confetti_speed }}s;
                --shawq-reward-confetti-1: {{ section.settings.reward_confetti_color_1.rgb }};
                --shawq-reward-confetti-2: {{ section.settings.reward_confetti_color_2.rgb }};
                --shawq-reward-confetti-3: {{ section.settings.reward_confetti_color_3.rgb }};
                {%- if section.settings.reward_message_weight != blank -%}
                  --shawq-reward-text-weight: {{ section.settings.reward_message_weight }};
                {%- endif -%}
              {%- endcapture -%}
              {%- assign reward_style = reward_style | strip_newlines | strip -%}

              <div class="cart-drawer__reward{% if reward_unlocked %} is-unlocked{% endif %}"
                data-shawq-gwp="true"
                data-gwp-enabled="{{ reward_enabled }}"
                data-gwp-threshold="{{ reward_threshold_cents }}"
                data-gwp-product-id="{{ reward_product.id }}"
                data-gwp-variant-id="{{ reward_product.selected_or_first_available_variant.id }}"
                data-gwp-remove="{{ section.settings.reward_remove_below_threshold }}"
                data-gwp-in-cart="{{ reward_in_cart }}"
                data-gwp-reward-key="{{ reward_line_item_key }}"
                {% if reward_style != blank %}style="{{ reward_style }}"{% endif %}
                {% unless reward_unlocked %}hidden{% endunless %}>
                {%- if section.settings.reward_message != blank -%}
                  <p class="cart-drawer__reward-message {{ section.settings.reward_message_size }}">
                    <span class="shawq-animated-text" data-anim="{{ section.settings.reward_message_animation }}" style="--shawq-text-anim-speed: var(--shawq-reward-text-anim-speed, 6s);">
                      {{- section.settings.reward_message -}}
                    </span>
                  </p>
                {%- endif -%}

                {%- if section.settings.reward_confetti_enable and reward_unlocked -%}
                  {%- assign confetti_count = section.settings.reward_confetti_count | default: 18 -%}
                  <div class="cart-drawer__reward-confetti" aria-hidden="true">
                    {%- for i in (1..confetti_count) -%}
                      {%- assign confetti_x = forloop.index0 | times: 7 | modulo: 100 -%}
                      {%- assign confetti_delay = forloop.index0 | times: 0.12 -%}
                      {%- assign confetti_size = 6 | plus: forloop.index0 | modulo: 4 -%}
                      {%- assign confetti_rotate = forloop.index0 | times: 37 | modulo: 360 -%}
                      {%- assign confetti_drift = forloop.index0 | times: 3 | modulo: 22 | minus: 11 -%}
                      {%- assign confetti_color_index = forloop.index0 | modulo: 3 | plus: 1 -%}
                      <span class="shawq-confetti"
                        style="--shawq-confetti-x: {{ confetti_x }}%; --shawq-confetti-delay: {{ confetti_delay }}s; --shawq-confetti-size: {{ confetti_size }}px; --shawq-confetti-rotate: {{ confetti_rotate }}deg; --shawq-confetti-drift: {{ confetti_drift }}px; --shawq-confetti-color: var(--shawq-reward-confetti-{{ confetti_color_index }});">
                      </span>
                    {%- endfor -%}
                  </div>
                {%- endif -%}
              </div>
            {%- endif -%}

            {%- comment -%}TRUST BADGES{%- endcomment -%}
            {%- assign trust_badges_block = section.blocks | where: 'type', 'trust_badges' | first -%}
            
            {%- if trust_badges_block != blank and section.settings.drawer_notice_text == blank -%}
              {%- assign rendered_item_count = 0 -%}

              {%- capture trust_badge_items -%}
                {%- for i in (1..3) -%}
                  {%- liquid
                    assign icon_setting = 'trust_' | append: i | append: '_icon'
                    assign icon_width_setting = 'trust_' | append: i | append: '_icon_width'
                    assign subheading_setting = 'trust_' | append: i | append: '_subheading'
                    assign content_setting = 'trust_' | append: i | append: '_content'
                  -%}

                  {%- if trust_badges_block.settings[subheading_setting] != blank or trust_badges_block.settings[content_setting] != blank -%}
                    {%- assign rendered_item_count = rendered_item_count | plus: 1 -%}

                    {%- capture subheading -%}
                      {%- if trust_badges_block.settings[subheading_setting] != blank -%}
                        <p class="medium">{{ trust_badges_block.settings[subheading_setting] }}</p>
                      {%- endif -%}
                    {%- endcapture -%}

                    <div class="offer-item justify-items-start" {{ trust_badges_block.shopify_attributes }}>
                      <div class="h-stack gap-2">
                        {%- render 'icon', image: trust_badges_block.settings[icon_setting], width: trust_badges_block.settings[icon_width_setting] -%}
                        {{- subheading -}}
                      </div>

                      {%- if trust_badges_block.settings[content_setting] != blank -%}
                        <div class="prose">
                          <p>{{ trust_badges_block.settings[content_setting] }}</p>
                        </div>
                      {%- endif -%}
                    </div>
                  {%- endif -%}
                {%- endfor -%}
              {%- endcapture -%}

              {%- if rendered_item_count > 0 -%}
                <div class="offer-carousel {% if rendered_item_count > 1 %}offer-carousel--navigation-inline{% endif %}" style="{% render 'surface', background: trust_badges_block.settings.background, text_color: trust_badges_block.settings.text_color %}">
                  <scroll-carousel id="carousel-{{ trust_badges_block.id }}" class="offer-carousel__scroller scroll-area">
                    {{- trust_badge_items -}}
                  </scroll-carousel>

                  {%- if rendered_item_count > 1 -%}
                    <carousel-navigation class="scroll-marker-group scroll-marker-group--dots scroll-marker-group--dots-sm" aria-controls="carousel-{{ trust_badges_block.id }}">
                      {%- for i in (1..rendered_item_count) -%}
                        <button class="scroll-marker" type="button" aria-current="{% if forloop.first %}true{% else %}false{% endif %}">
                          <span class="sr-only">{{ 'general.accessibility.go_to_item' | t: index: forloop.index }}</span>
                        </button>
                      {%- endfor -%}
                    </carousel-navigation>
                  {%- endif -%}
                </div>
              {%- endif -%}
            {%- endif -%}

            {%- comment -%}LINE ITEMS{%- endcomment -%}

            {%- for line_item in cart.items -%}
              {%- render 'line-item', line_item: line_item, show_line_price: true, hide_unit_price: true, show_quantity_selector: true -%}
            {%- endfor -%}

            

            {%- comment -%}SHAWQ STYLE ADD-ON{%- endcomment -%}
            {%- assign style_addon_product = section.settings.style_addon_product -%}
            {%- if style_addon_product != blank -%}
              {%- assign style_addon_in_cart = false -%}
              {%- for li in cart.items -%}
                {%- if li.product_id == style_addon_product.id -%}
                  {%- assign style_addon_in_cart = true -%}
                {%- endif -%}
              {%- endfor -%}

              {%- if style_addon_in_cart == false -%}
                {%- assign style_addon_background = section.settings.color_scheme.settings.secondary_background -%}
                {%- if section.settings.style_addon_plain -%}
                  {%- assign style_addon_background = blank -%}
                {%- endif -%}

                {%- capture style_addon_style -%}
                  --shawq-aov-border-width: {{ section.settings.style_addon_border_width }}px;
                  --shawq-aov-border-opacity: {{ section.settings.style_addon_border_opacity }};
                  --shawq-aov-border-color: {{ section.settings.style_addon_border_color.rgb }};
                  --shawq-aov-border-radius: {{ section.settings.style_addon_border_radius }}px;
                  --shawq-aov-border-padding: {{ section.settings.style_addon_border_padding }}px;
                  --shawq-aov-border-style: {{ section.settings.style_addon_border_style }};
                  --shawq-aov-anim-speed: {{ section.settings.style_addon_card_anim_speed }}s;
                  --shawq-aov-anim-intensity: {{ section.settings.style_addon_card_anim_intensity }};
                  --shawq-text-anim-speed: {{ section.settings.style_addon_text_anim_speed }}s;
                {%- endcapture -%}
                {%- assign style_addon_style = style_addon_style | strip_newlines | strip -%}

                <div class="shawq-style-addon v-stack gap-2{% if section.settings.style_addon_plain %} shawq-style-addon--plain{% endif %}"
                  data-aov-border="{{ section.settings.style_addon_border_enable }}"
                  data-aov-animation="{{ section.settings.style_addon_card_animation }}"
                  data-aov-text-animation="{{ section.settings.style_addon_text_animation }}"
                  {% if style_addon_style != blank %}style="{{ style_addon_style }}"{% endif %}>
                  {%- if section.settings.style_addon_title != blank -%}
                    <p class="h7">
                      <span class="shawq-animated-text" data-anim="{{ section.settings.style_addon_text_animation }}">
                        {{ section.settings.style_addon_title }}
                      </span>
                    </p>
                  {%- endif -%}

                  {%- if section.settings.style_addon_subtitle != blank -%}
                    <p class="text-sm text-subdued">{{ section.settings.style_addon_subtitle }}</p>
                  {%- endif -%}

                  {%- render 'product-cross-sell', product: style_addon_product, layout: 'horizontal', show_quick_buy: true, background: style_addon_background -%}
                </div>
              {%- endif -%}
            {%- endif -%}


            {%- comment -%}CROSS-SELL{%- endcomment -%}

            {%- if section.settings.enable_cross_sell -%}
              <product-recommendations hidden product="{{ cart.items.first.product_id }}" limit="10" intent="complementary" section-id="{{ section.id }}">
                {%- if recommendations.performed? and recommendations.intent == 'complementary' and recommendations.products_count > 0 -%}
                  {%- assign recommendations_count = 0 -%}
                  {%- assign carousel_id = 'cart-drawer-cross-sell-' | append: section.id -%}

                  {%- capture product_recommendations -%}
                    <scroll-carousel id="{{ carousel_id }}" class="cart-drawer__cross-sell-carousel scroll-area bleed">
                      {%- for product in recommendations.products -%}
                        {%- assign line_items_for_product = cart.items | where: 'product_id', product.id -%}

                        {%- if line_items_for_product.size == 0 -%}
                          {%- comment -%}We only show recommendations of products that do not exist in the cart yet{%- endcomment -%}
                          {%- assign recommendations_count = recommendations_count | plus: 1 -%}

                          {%- render 'product-cross-sell', product: product, layout: 'horizontal', show_quick_buy: true, background: section.settings.color_scheme.settings.secondary_background -%}
                        {%- endif -%}
                      {%- endfor -%}
                    </scroll-carousel>
                  {%- endcapture -%}
                  
                  {%- if recommendations_count > 0 -%}
                    <div class="cart-drawer__cross-sell">
                      <div class="h-stack justify-between gap-2">
                        {%- if section.settings.cross_sell_title != blank -%}
                          <p class="h7">{{ section.settings.cross_sell_title }}</p>
                        {%- endif -%}

                        {%- if recommendations_count > 1 -%}
                          <div class="h-stack gap-2">
                            <carousel-prev-button aria-controls="{{ carousel_id }}">
                              <button type="button" class="circle-button" disabled>
                                <span class="sr-only">{{ 'general.accessibility.previous' | t }}</span>
                                {%- render 'icon' with 'big-arrow-left', width: 9, direction_aware: true -%}
                              </button>
                            </carousel-prev-button>

                            <carousel-next-button aria-controls="{{ carousel_id }}">
                              <button type="button" class="circle-button">
                                <span class="sr-only">{{ 'general.accessibility.next' | t }}</span>
                                {%- render 'icon' with 'big-arrow-right', width: 9, direction_aware: true -%}
                              </button>
                            </carousel-next-button>
                          </div>
                        {%- endif -%}
                      </div>

                      {{- product_recommendations -}}
                    </div>
                  {%- endif -%}
                {%- endif -%}
              </product-recommendations>
            {%- endif -%}

            <div class="cart-drawer__checkout">
              {%- form 'cart', cart, id: 'cart-drawer-form' -%}
                {%- if section.settings.show_cart_note or section.settings.show_shipping_estimator -%}
                  <div class="cart-drawer__footer-actions divide-x">
                    {%- if section.settings.show_cart_note -%}
                      <x-drawer-popover class="drawer-popover" id="cart-drawer-order-note-popover">
                        <p slot="header" class="subheading">{{ 'cart.general.order_note' | t }}</p>
                        
                        <div class="form">
                          {%- assign field_label = 'cart.general.add_order_note' | t -%}

                          <cart-note>
                            {%- render 'input', name: 'note', value: cart.note, label: field_label, multiline: 5 -%}
                          </cart-note>

                          <dialog-close-button>
                            {%- assign button_label = 'cart.general.save_note' | t -%}
                            {%- render 'button', type: 'button', content: button_label, class: 'justify-self-start' -%}
                          </dialog-close-button>
                        </div>
                      </x-drawer-popover>

                      <button type="button" class="cart-drawer__footer-action-button subheading" aria-controls="cart-drawer-order-note-popover" aria-expanded="false">
                        {%- render 'icon' with 'order-note' -%}
                        {{- 'cart.general.order_note' | t -}}
                      </button>
                    {%- endif -%}

                    {%- if section.settings.show_shipping_estimator -%}
                      <x-drawer-popover class="drawer-popover" id="cart-drawer-shipping-estimator-popover">
                        <p slot="header" class="subheading">{{ 'cart.shipping_estimator.estimate_shipping' | t }}</p>
                        
                        {%- render 'shipping-estimator' -%}
                      </x-drawer-popover>

                      <button type="button" class="cart-drawer__footer-action-button subheading" aria-controls="cart-drawer-shipping-estimator-popover" aria-expanded="false">
                        {%- render 'icon' with 'shipping-estimator' -%}
                        {{- 'cart.shipping_estimator.estimate_shipping' | t -}}
                      </button>
                    {%- endif -%}
                  </div>
                {%- endif -%}

                <div class="cart-drawer__footer-inner">
                  <div class="v-stack gap-4">
                    {%- if section.settings.show_terms_of_service_checkbox -%}
                      <!-- TERMS BOX -->
                      <div class="checkbox-control text-xs">
                        <input id="cart-drawer-terms-of-service" type="checkbox" class="checkbox" required value="1">

                        {%- if shop.terms_of_service == blank -%}
                          <label for="cart-drawer-terms-of-service">{{ 'cart.general.terms_of_services_checkbox' | t }}</label>
                        {%- else -%}
                          <label for="cart-drawer-terms-of-service">{{ 'cart.general.terms_of_services_checkbox_with_link_html' | t: link: shop.terms_of_service.url }}</label>
                        {%- endif -%}
                      </div>
                    {%- endif -%}

                    <!-- TOTALS -->
                    <div class="v-stack gap-1.5">
                      {% for discount_application in cart.cart_level_discount_applications %}
                        <div class="h-stack justify-between gap-4">
                          <span class="h-stack gap-2">{%- render 'icon' with 'discount', width: 12 -%} {{- discount_application.title -}}</span>
                          <span class="text-subdued">-{{ discount_application.total_allocated_amount | money }}</span>
                        </div>
                      {% endfor %}

                      <div class="h-stack justify-between gap-4">
                        <span class="medium uppercase">{{ 'cart.general.total' | t }}</span>
                        <span class="medium">{{ cart.total_price | money }}</span>
                      </div>
                    </div>

                    <!-- BUTTONS -->
                    <div class="v-stack gap-3">
                      <div class="button-group button-group--same-width w-full">
                        {%- liquid
                          assign checkout_button_style = settings.shawq_checkout_button_style | default: 'solid'

                          if section.settings.show_view_cart_button
                            assign button_content = 'cart.general.view_cart' | t
                            assign button_style = 'solid'

                            if section.settings.show_checkout_button
                              assign button_style = 'outline'
                            endif

                            render 'button', content: button_content, style: button_style, href: routes.cart_url, type: 'button'
                          endif

                          if section.settings.show_checkout_button
                            assign button_content = 'cart.general.checkout' | t
                            render 'button', content: button_content, type: 'submit', name: 'checkout', form: 'cart-drawer-form', style: checkout_button_style
                          endif
                        -%}
                      </div>

                      {%- if section.settings.show_shipping_text -%}
                        {%- liquid
                          if cart.taxes_included and shop.shipping_policy.body != blank
                            assign shipping_text = 'cart.general.taxes_included_and_shipping_policy_html' | t: link: shop.shipping_policy.url
                          elsif cart.taxes_included
                            assign shipping_text = 'cart.general.taxes_included_but_shipping_at_checkout' | t
                          elsif shop.shipping_policy.body != blank
                            assign shipping_text = 'cart.general.taxes_and_shipping_policy_at_checkout_html' | t: link: shop.shipping_policy.url
                          else
                            assign shipping_text = 'cart.general.taxes_and_shipping_at_checkout' | t
                          endif
                        -%}

                        <p class="text-center text-subdued text-xs">{{ shipping_text }}</p>
                      {%- endif -%}
                    </div>
                  </div>
                </div>
              {%- endform -%}
            </div>
          </div>
        </div>
      {%- endif -%}
    {%- endcapture -%}

    {%- if offers_content != blank -%}
      <x-tabs class="tab-pills">
        <button type="button" slot="tab">
          {%- render 'icon' with 'cart' -%}
          <span class="subheading">{{ 'cart.general.title' | t }}</span>
        </button>
    
        <div slot="tabpanel" {% if cart.empty? %}class="align-self-center"{% endif %}>{{- cart_content -}}</div>
    
        <button type="button" slot="tab">
          {%- render 'icon' with 'gift' -%}
          <span class="subheading tab-pills__dot-indicator">{{- 'cart.general.offers' | t -}}</span>
        </button>
    
        <div slot="tabpanel">{{- offers_content -}}</div>
      </x-tabs>
    {%- else -%}
      {{- cart_content -}}
    {%- endif -%}

  </cart-drawer>
{%- endif -%}

{% schema %}
{
  "name": "t:sections.cart_drawer.name",
  "class": "shopify-section--cart-drawer",
  "tag": "section",
  "settings": [
    {
      "type": "paragraph",
      "content": "t:sections.cart_drawer.page_info"
    },
    {
      "type": "paragraph",
      "content": "t:sections.cart_drawer.free_shipping_bar_info"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:global.colors.scheme",
      "default": "scheme-1"
    },
    {
      "type": "checkbox",
      "id": "show_cart_note",
      "label": "t:sections.cart_drawer.show_cart_note",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_shipping_estimator",
      "label": "t:sections.cart_drawer.show_shipping_estimator",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_shipping_text",
      "label": "t:sections.cart_drawer.show_shipping_text",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_terms_of_service_checkbox",
      "label": "t:sections.cart_drawer.show_terms_of_service_checkbox",
      "info": "t:sections.cart_drawer.show_terms_of_service_checkbox_info",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_view_cart_button",
      "label": "t:sections.cart_drawer.show_view_cart_button",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_checkout_button",
      "label": "t:sections.cart_drawer.show_checkout_button",
      "default": true
    },
    {
      "type": "header",
      "content": "Shawq — Drawer notice"
    },
    {
      "type": "inline_richtext",
      "id": "drawer_notice_text",
      "label": "Notice text"
    },
    {
      "type": "color",
      "id": "drawer_notice_color",
      "label": "Notice text color",
      "default": "#ff2f7d"
    },
    {
      "type": "select",
      "id": "drawer_notice_weight",
      "label": "Notice font weight",
      "options": [
        {
          "value": "",
          "label": "Theme default"
        },
        {
          "value": "400",
          "label": "400"
        },
        {
          "value": "500",
          "label": "500"
        },
        {
          "value": "600",
          "label": "600"
        },
        {
          "value": "700",
          "label": "700"
        },
        {
          "value": "800",
          "label": "800"
        }
      ],
      "default": ""
    },
    {
      "type": "header",
      "content": "Shawq — Drawer typography"
    },
    {
      "type": "color",
      "id": "drawer_text_color",
      "label": "Text color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "drawer_muted_text_color",
      "label": "Muted text color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "drawer_heading_color",
      "label": "Heading color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "drawer_price_color",
      "label": "Price color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "select",
      "id": "drawer_body_weight",
      "label": "Body font weight",
      "options": [
        {
          "value": "",
          "label": "Theme default"
        },
        {
          "value": "300",
          "label": "300"
        },
        {
          "value": "400",
          "label": "400"
        },
        {
          "value": "500",
          "label": "500"
        },
        {
          "value": "600",
          "label": "600"
        },
        {
          "value": "700",
          "label": "700"
        },
        {
          "value": "800",
          "label": "800"
        }
      ],
      "default": ""
    },
    {
      "type": "select",
      "id": "drawer_heading_weight",
      "label": "Heading font weight",
      "options": [
        {
          "value": "",
          "label": "Theme default"
        },
        {
          "value": "300",
          "label": "300"
        },
        {
          "value": "400",
          "label": "400"
        },
        {
          "value": "500",
          "label": "500"
        },
        {
          "value": "600",
          "label": "600"
        },
        {
          "value": "700",
          "label": "700"
        },
        {
          "value": "800",
          "label": "800"
        }
      ],
      "default": ""
    },
    {
      "type": "select",
      "id": "drawer_price_weight",
      "label": "Price font weight",
      "options": [
        {
          "value": "",
          "label": "Theme default"
        },
        {
          "value": "300",
          "label": "300"
        },
        {
          "value": "400",
          "label": "400"
        },
        {
          "value": "500",
          "label": "500"
        },
        {
          "value": "600",
          "label": "600"
        },
        {
          "value": "700",
          "label": "700"
        },
        {
          "value": "800",
          "label": "800"
        }
      ],
      "default": ""
    },
    {
      "type": "header",
      "content": "Shawq — Drawer buttons"
    },
    {
      "type": "color",
      "id": "drawer_button_background",
      "label": "Button background",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "drawer_button_text_color",
      "label": "Button text color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "select",
      "id": "drawer_button_weight",
      "label": "Button font weight",
      "options": [
        {
          "value": "",
          "label": "Theme default"
        },
        {
          "value": "300",
          "label": "300"
        },
        {
          "value": "400",
          "label": "400"
        },
        {
          "value": "500",
          "label": "500"
        },
        {
          "value": "600",
          "label": "600"
        },
        {
          "value": "700",
          "label": "700"
        },
        {
          "value": "800",
          "label": "800"
        }
      ],
      "default": ""
    },
    {
      "type": "header",
      "content": "Shawq — Cart reward"
    },
    {
      "type": "checkbox",
      "id": "reward_enable",
      "label": "Enable reward unlock",
      "default": true
    },
    {
      "type": "product",
      "id": "reward_product",
      "label": "Reward product"
    },
    {
      "type": "range",
      "id": "reward_threshold",
      "label": "Unlock threshold",
      "min": 50,
      "max": 1000,
      "step": 10,
      "unit": "USD",
      "default": 250
    },
    {
      "type": "checkbox",
      "id": "reward_remove_below_threshold",
      "label": "Remove reward if cart drops below threshold",
      "default": true
    },
    {
      "type": "inline_richtext",
      "id": "reward_message",
      "label": "Reward message",
      "default": "CONGRATULATIONS! YOU HAVE UNLOCKED THE EXCLUSIVE PALESTINE ART-FRAME"
    },
    {
      "type": "color",
      "id": "reward_message_color",
      "label": "Reward message color",
      "default": "#ff2f7d"
    },
    {
      "type": "select",
      "id": "reward_message_weight",
      "label": "Reward message weight",
      "options": [
        {
          "value": "",
          "label": "Theme default"
        },
        {
          "value": "400",
          "label": "400"
        },
        {
          "value": "500",
          "label": "500"
        },
        {
          "value": "600",
          "label": "600"
        },
        {
          "value": "700",
          "label": "700"
        },
        {
          "value": "800",
          "label": "800"
        }
      ],
      "default": "600"
    },
    {
      "type": "select",
      "id": "reward_message_size",
      "label": "Reward message size",
      "options": [
        {
          "value": "text-sm",
          "label": "Small"
        },
        {
          "value": "text-base",
          "label": "Medium"
        },
        {
          "value": "text-lg",
          "label": "Large"
        }
      ],
      "default": "text-sm"
    },
    {
      "type": "select",
      "id": "reward_message_animation",
      "label": "Reward message animation",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "shine",
          "label": "Shine"
        },
        {
          "value": "glow",
          "label": "Glow"
        },
        {
          "value": "underline",
          "label": "Underline sweep"
        }
      ],
      "default": "shine"
    },
    {
      "type": "range",
      "id": "reward_message_anim_speed",
      "label": "Reward message animation speed",
      "min": 3,
      "max": 12,
      "step": 1,
      "unit": "s",
      "default": 6
    },
    {
      "type": "header",
      "content": "Reward confetti"
    },
    {
      "type": "checkbox",
      "id": "reward_confetti_enable",
      "label": "Show confetti burst",
      "default": true
    },
    {
      "type": "range",
      "id": "reward_confetti_count",
      "label": "Confetti density",
      "min": 8,
      "max": 30,
      "step": 2,
      "default": 18
    },
    {
      "type": "range",
      "id": "reward_confetti_speed",
      "label": "Confetti speed",
      "min": 1,
      "max": 5,
      "step": 0.5,
      "unit": "s",
      "default": 2
    },
    {
      "type": "color",
      "id": "reward_confetti_color_1",
      "label": "Confetti color 1",
      "default": "#ff2f7d"
    },
    {
      "type": "color",
      "id": "reward_confetti_color_2",
      "label": "Confetti color 2",
      "default": "#ffd166"
    },
    {
      "type": "color",
      "id": "reward_confetti_color_3",
      "label": "Confetti color 3",
      "default": "#7bdff2"
    },
    {
      "type": "header",
      "content": "Shawq — AOV add-on"
    },
    {
      "type": "product",
      "id": "style_addon_product",
      "label": "Add-on product (e.g., keffiyeh)"
    },
    {
      "type": "inline_richtext",
      "id": "style_addon_title",
      "label": "Title",
      "default": "Complete the look"
    },
    {
      "type": "inline_richtext",
      "id": "style_addon_subtitle",
      "label": "Subheading",
      "default": "Add a keffiyeh — completes the outfit in one tap."
    },
    {
      "type": "header",
      "content": "Add-on border"
    },
    {
      "type": "checkbox",
      "id": "style_addon_border_enable",
      "label": "Enable add-on border",
      "default": true
    },
    {
      "type": "color",
      "id": "style_addon_border_color",
      "label": "Border color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "style_addon_border_opacity",
      "label": "Border opacity",
      "min": 0.05,
      "max": 0.5,
      "step": 0.05,
      "default": 0.1
    },
    {
      "type": "range",
      "id": "style_addon_border_width",
      "label": "Border thickness",
      "min": 1,
      "max": 4,
      "step": 1,
      "unit": "px",
      "default": 1
    },
    {
      "type": "select",
      "id": "style_addon_border_style",
      "label": "Border style",
      "options": [
        {
          "value": "solid",
          "label": "Solid"
        },
        {
          "value": "dashed",
          "label": "Dashed"
        },
        {
          "value": "dotted",
          "label": "Dotted"
        }
      ],
      "default": "solid"
    },
    {
      "type": "range",
      "id": "style_addon_border_radius",
      "label": "Border radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "style_addon_border_padding",
      "label": "Border padding",
      "min": 0,
      "max": 24,
      "step": 2,
      "unit": "px",
      "default": 12
    },
    {
      "type": "header",
      "content": "Add-on animation"
    },
    {
      "type": "select",
      "id": "style_addon_card_animation",
      "label": "Card animation",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "shimmer",
          "label": "Shimmer"
        },
        {
          "value": "glow",
          "label": "Glow"
        },
        {
          "value": "float",
          "label": "Float"
        }
      ],
      "default": "shimmer"
    },
    {
      "type": "range",
      "id": "style_addon_card_anim_speed",
      "label": "Card animation speed",
      "min": 4,
      "max": 16,
      "step": 1,
      "unit": "s",
      "default": 10
    },
    {
      "type": "range",
      "id": "style_addon_card_anim_intensity",
      "label": "Card animation intensity",
      "min": 0.1,
      "max": 1.0,
      "step": 0.1,
      "default": 0.4
    },
    {
      "type": "select",
      "id": "style_addon_text_animation",
      "label": "Title text animation",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "shine",
          "label": "Shine"
        },
        {
          "value": "glow",
          "label": "Glow"
        },
        {
          "value": "underline",
          "label": "Underline sweep"
        }
      ],
      "default": "shine"
    },
    {
      "type": "range",
      "id": "style_addon_text_anim_speed",
      "label": "Title animation speed",
      "min": 3,
      "max": 12,
      "step": 1,
      "unit": "s",
      "default": 6
    },
    {
      "type": "checkbox",
      "id": "style_addon_plain",
      "label": "Remove add-on card background",
      "default": false
    },
    {
      "type": "header",
      "content": "t:sections.cart_drawer.cross_sell_category",
      "info": "t:sections.cart_drawer.cross_sell_category_info"
    },
    {
      "type": "checkbox",
      "id": "enable_cross_sell",
      "label": "t:sections.cart_drawer.enable_cross_sell",
      "default": true
    },
    {
      "type": "inline_richtext",
      "id": "cross_sell_title",
      "label": "t:global.text.title",
      "default": "You may also like"
    }
  ],
  "blocks": [
    {
      "type": "trust_badges",
      "limit": 1,
      "name": "t:sections.cart_drawer.blocks.trust_badges.name",
      "settings": [
        {
          "type": "paragraph",
          "content": "t:sections.cart_drawer.blocks.trust_badges.instructions"
        },
        {
          "type": "color",
          "id": "background",
          "label": "t:global.colors.background",
          "default": "#eef3fd"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "t:global.colors.text",
          "default": "#0033dd"
        },
        {
          "type": "header",
          "content": "t:sections.cart_drawer.blocks.trust_badges.trust_1_category"
        },
        {
          "type": "image_picker",
          "id": "trust_1_icon",
          "label": "t:global.icons.icon",
          "info": "t:global.icons.custom_icon_info"
        },
        {
          "type": "range",
          "id": "trust_1_icon_width",
          "label": "t:global.icons.icon_width",
          "min": 16,
          "max": 48,
          "step": 2,
          "unit": "px",
          "default": 16
        },
        {
          "type": "inline_richtext",
          "id": "trust_1_subheading",
          "label": "t:global.text.subheading"
        },
        {
          "type": "inline_richtext",
          "id": "trust_1_content",
          "label": "t:global.text.content"
        },
        {
          "type": "header",
          "content": "t:sections.cart_drawer.blocks.trust_badges.trust_2_category"
        },
        {
          "type": "image_picker",
          "id": "trust_2_icon",
          "label": "t:global.icons.icon",
          "info": "t:global.icons.custom_icon_info"
        },
        {
          "type": "range",
          "id": "trust_2_icon_width",
          "label": "t:global.icons.icon_width",
          "min": 16,
          "max": 48,
          "step": 2,
          "unit": "px",
          "default": 16
        },
        {
          "type": "inline_richtext",
          "id": "trust_2_subheading",
          "label": "t:global.text.subheading"
        },
        {
          "type": "inline_richtext",
          "id": "trust_2_content",
          "label": "t:global.text.content"
        },
        {
          "type": "header",
          "content": "t:sections.cart_drawer.blocks.trust_badges.trust_3_category"
        },
        {
          "type": "image_picker",
          "id": "trust_3_icon",
          "label": "t:global.icons.icon",
          "info": "t:global.icons.custom_icon_info"
        },
        {
          "type": "range",
          "id": "trust_3_icon_width",
          "label": "t:global.icons.icon_width",
          "min": 16,
          "max": 48,
          "step": 2,
          "unit": "px",
          "default": 16
        },
        {
          "type": "inline_richtext",
          "id": "trust_3_subheading",
          "label": "t:global.text.subheading"
        },
        {
          "type": "inline_richtext",
          "id": "trust_3_content",
          "label": "t:global.text.content"
        }
      ]
    },
    {
      "type": "offer_banner",
      "name": "t:sections.cart_drawer.blocks.offer_banner.name",
      "settings": [
        {
          "type": "select",
          "id": "layout",
          "label": "t:sections.cart_drawer.blocks.offer.layout",
          "options": [
            {
              "value": "half_width",
              "label": "t:sections.cart_drawer.blocks.offer.layout_options.half_width"
            },
            {
              "value": "full_width",
              "label": "t:sections.cart_drawer.blocks.offer.layout_options.full_width"
            }
          ],
          "default": "full_width"
        },
        {
          "type": "image_picker",
          "id": "icon",
          "label": "t:global.icons.icon",
          "info": "t:global.icons.custom_icon_info"
        },
        {
          "type": "range",
          "id": "icon_width",
          "label": "t:global.icons.icon_width",
          "min": 16,
          "max": 48,
          "step": 2,
          "unit": "px",
          "default": 24
        },
        {
          "type": "inline_richtext",
          "id": "subheading",
          "label": "t:global.text.subheading",
          "default": "Subheading"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "t:global.text.content",
          "default": "<p>Share a discount code, promote a sale or free shipping offer...</p>"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "t:global.text.button_text",
          "default": "Button text"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "t:global.text.button_link"
        },
        {
          "type": "checkbox",
          "id": "button_copy_on_click",
          "label": "t:sections.cart_drawer.blocks.offer.button_copy_on_click",
          "default": false
        },
        {
          "type": "header",
          "content": "t:global.colors.category"
        },
        {
          "type": "color",
          "id": "background",
          "label": "t:global.colors.background",
          "default": "#eef3fd"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "t:global.colors.text",
          "default": "#0033dd"
        }
      ]
    },
    {
      "type": "offer_image",
      "name": "t:sections.cart_drawer.blocks.offer_image.name",
      "settings": [
        {
          "type": "select",
          "id": "layout",
          "label": "t:sections.cart_drawer.blocks.offer.layout",
          "options": [
            {
              "value": "half_width",
              "label": "t:sections.cart_drawer.blocks.offer.layout_options.half_width"
            },
            {
              "value": "full_width",
              "label": "t:sections.cart_drawer.blocks.offer.layout_options.full_width"
            }
          ],
          "default": "full_width"
        },
        {
          "type": "image_picker",
          "id": "background_image",
          "label": "t:global.image.background_image",
          "info": "t:sections.cart_drawer.blocks.offer_image.background_image_size_recommendation"
        },
        {
          "type": "inline_richtext",
          "id": "heading",
          "label": "t:global.text.content",
          "default": "Share something"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "t:global.text.button_text",
          "default": "Button text"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "t:global.text.button_link"
        },
        {
          "type": "select",
          "id": "button_style",
          "label": "t:global.text.button_style",
          "options": [
            {
              "value": "outline",
              "label": "t:global.text.button_style_options.outline"
            },
            {
              "value": "solid",
              "label": "t:global.text.button_style_options.solid"
            },
            {
              "value": "link",
              "label": "t:global.text.button_style_options.link"
            }
          ],
          "default": "solid"
        },
        {
          "type": "header",
          "content": "t:global.colors.category"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "t:global.colors.text",
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "button_background",
          "label": "t:global.colors.button_background",
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "button_text_color",
          "label": "t:global.colors.button_text",
          "default": "#000000"
        }
      ]
    }
  ]
}
{% endschema %}
